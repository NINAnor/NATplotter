---
title: "testing"
format: html
editor: visual
---

```{r}
library(tidyverse)
```


```{r}
dir <- substr(getwd(), 1,2)

path <- ifelse(dir == "C:", 
               "P:/41001581_egenutvikling_anders_kolstad/data/",
               "/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/data/")
naturtyper <- readRDS(paste0(path, "naturtyper.rds"))
```

```{r}
 summary1 <- naturtyper %>%
    group_by(tilstand) %>%
    summarise(Antall_lokaliteter = n(),
              Areal_km2 = round(sum(km2), 0))
```

```{r}
ggplot(summary1, aes(x = tilstand, y = Antall_lokaliteter))+
      geom_bar(stat="identity",
               fill = "grey80",
               colour = "grey20",
               linewidth=1.5)+
      theme_bw(base_size = 12)
```


```{r}
myvar <- rlang::sym("tilstand")

summary2 <- naturtyper %>%
    group_by(myVar = !!myvar) %>%
    summarise(Antall_lokaliteter = n(),
              Areal_km2 = round(sum(km2), 0))
class(summary2)
```

```{r}
ggplot(summary2, aes_string(x = "myVar", y = "Antall_lokaliteter"))+
      geom_bar(stat="identity",
               fill = "grey80",
               colour = "grey20",
               linewidth=1.5)+
      theme_bw(base_size = 12)
```

```{r}
naturtyper %>%
      filter(naturtype == "Naturbeitemark") %>%
      group_by(kartleggingsår) %>%
      summarise(Antall_lokaliteter = n(),
                Areal_km2 = round(sum(km2), 0)) 
```

```{r}
temp <- dat2_long %>% filter(naturtype == "Naturbeitemark") %>%
  group_by(NiN_variable_code, NiN_variable_value) %>%
      summarise(Antall_lokaliteter = n(),
                Areal_km2 = round(sum(km2), 0))

ggplot(temp, aes(x = NiN_variable_value, y = Antall_lokaliteter))+
  geom_bar(stat="identity",
               fill = "#FF9933",
               colour = "grey20",
               linewidth=1.5)+
      theme_bw(base_size = 12)+
  facet_wrap(.~NiN_variable_code,
             scales = "free",
             ncol = 3)
```


```{r}
ggplot(temp[temp$NiN_variable_code=="PRHA",], aes(x = NiN_variable_value, y = Antall_lokaliteter))+
  geom_bar(stat="identity",
               fill = "#FF9933",
               colour = "grey20",
               linewidth=1.5)+
      theme_bw(base_size = 12)
```


```{r}
temp2 <- temp %>%
  group_by(tilstand) %>%
  summarise(n = n())
```

```{r}
ggplot(temp, aes(x = tilstand, y = n))+
  geom_bar(stat = "identity")
```



```{r}
cond <- TRUE
naturtyper_long_selected_var <- 
   naturtyper_long %>% 
     filter(naturtype == "Naturbeitemark") %>%
     filter(NiN_variable_code == "PRRL-EN") %>%
     group_by(NiN_variable_code, NiN_variable_value) %>%
     { if (cond) group_by(., kartleggingsår, .add=T) else . } %>%
     summarise(Antall_lokaliteter = n(),
               Areal_km2 = round(sum(km2), 0))
```

```{r}
ggplot(naturtyper_long_selected_var, aes(x = NiN_variable_value, y = Antall_lokaliteter))+
    geom_bar(stat="identity",
             fill = "#FF9933",
             colour = "grey20",
             linewidth=1.5)+
    theme_bw(base_size = myBase_size) +
  facet_grid(vars(kartleggingsår))
```


























